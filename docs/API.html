<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyRaven Package &mdash; Raven  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="04 - Calculate probabilites from the chi2 files" href="nblink/04-CalculateProbabilities.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Raven
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to run pyRaven tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nblink/01-DataSetup.html">01 - Data Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="nblink/02-FitIntensity.html">02- Fit of the intensity profiles for single stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="nblink/03-ChiSquareCalcLoop.html">03- Calculating the chi2 with the loop code</a></li>
<li class="toctree-l1"><a class="reference internal" href="nblink/04-CalculateProbabilities.html">04 - Calculate probabilites from the chi2 files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pyRaven Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.data">data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.DataPacket"><code class="docutils literal notranslate"><span class="pre">DataPacket</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.data.DataPacket.__init__"><code class="docutils literal notranslate"><span class="pre">DataPacket.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.data.DataPacket.write"><code class="docutils literal notranslate"><span class="pre">DataPacket.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.LSDprofs"><code class="docutils literal notranslate"><span class="pre">LSDprofs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.data.LSDprofs.__init__"><code class="docutils literal notranslate"><span class="pre">LSDprofs.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.data.LSDprofs.write"><code class="docutils literal notranslate"><span class="pre">LSDprofs.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.create_Packet"><code class="docutils literal notranslate"><span class="pre">create_Packet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.read_lsd"><code class="docutils literal notranslate"><span class="pre">read_lsd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.read_lsds"><code class="docutils literal notranslate"><span class="pre">read_lsds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.read_lsds_from_sfiles"><code class="docutils literal notranslate"><span class="pre">read_lsds_from_sfiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.data.read_packet"><code class="docutils literal notranslate"><span class="pre">read_packet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.params">parameter module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.params.MyJSONEncoder"><code class="docutils literal notranslate"><span class="pre">MyJSONEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.params.MyJSONEncoder.default"><code class="docutils literal notranslate"><span class="pre">MyJSONEncoder.default()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.params.get_def_param_fitI"><code class="docutils literal notranslate"><span class="pre">get_def_param_fitI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.params.get_def_param_weak"><code class="docutils literal notranslate"><span class="pre">get_def_param_weak()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.params.parameters"><code class="docutils literal notranslate"><span class="pre">parameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.params.parameters.pprint"><code class="docutils literal notranslate"><span class="pre">parameters.pprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pyRaven.params.parameters.write"><code class="docutils literal notranslate"><span class="pre">parameters.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.params.read_parameters"><code class="docutils literal notranslate"><span class="pre">read_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.pattern">pattern module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.profileI">profileI module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.profileI.voigt_fara"><code class="docutils literal notranslate"><span class="pre">voigt_fara()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.localV">localV module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.localV.unno_local_out_IV"><code class="docutils literal notranslate"><span class="pre">unno_local_out_IV()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">localV module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.analytical"><code class="docutils literal notranslate"><span class="pre">analytical()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_B_LOS"><code class="docutils literal notranslate"><span class="pre">get_B_LOS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_B_MAG"><code class="docutils literal notranslate"><span class="pre">get_B_MAG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_LOS"><code class="docutils literal notranslate"><span class="pre">get_LOS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_LOS_values"><code class="docutils literal notranslate"><span class="pre">get_LOS_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_MAG"><code class="docutils literal notranslate"><span class="pre">get_MAG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_all_u"><code class="docutils literal notranslate"><span class="pre">get_all_u()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_empty_model"><code class="docutils literal notranslate"><span class="pre">get_empty_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_local_weak_interp"><code class="docutils literal notranslate"><span class="pre">get_local_weak_interp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_local_weak_interp_Vonly_numba"><code class="docutils literal notranslate"><span class="pre">get_local_weak_interp_Vonly_numba()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_los2rot"><code class="docutils literal notranslate"><span class="pre">get_los2rot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_ngrid"><code class="docutils literal notranslate"><span class="pre">get_ngrid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_perGaussLorentz"><code class="docutils literal notranslate"><span class="pre">get_perGaussLorentz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_resmac_kernel"><code class="docutils literal notranslate"><span class="pre">get_resmac_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_rot2mag"><code class="docutils literal notranslate"><span class="pre">get_rot2mag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_rotKernel"><code class="docutils literal notranslate"><span class="pre">get_rotKernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_small_u"><code class="docutils literal notranslate"><span class="pre">get_small_u()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_uconv"><code class="docutils literal notranslate"><span class="pre">get_uconv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_unno_angles"><code class="docutils literal notranslate"><span class="pre">get_unno_angles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_vel_range_unno"><code class="docutils literal notranslate"><span class="pre">get_vel_range_unno()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_w_unno"><code class="docutils literal notranslate"><span class="pre">get_w_unno()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.get_w_weak"><code class="docutils literal notranslate"><span class="pre">get_w_weak()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.grid_ROT"><code class="docutils literal notranslate"><span class="pre">grid_ROT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.model_convolve_resvmac"><code class="docutils literal notranslate"><span class="pre">model_convolve_resvmac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.numerical"><code class="docutils literal notranslate"><span class="pre">numerical()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.pad_V"><code class="docutils literal notranslate"><span class="pre">pad_V()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.diskint2.pad_model"><code class="docutils literal notranslate"><span class="pre">pad_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyRaven.loop">loop module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.loop.loop"><code class="docutils literal notranslate"><span class="pre">loop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyRaven.loop.loop_wrapper"><code class="docutils literal notranslate"><span class="pre">loop_wrapper()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Raven</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pyRaven Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/API.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyraven-package">
<h1>pyRaven Package<a class="headerlink" href="#pyraven-package" title="Permalink to this heading"></a></h1>
<section id="module-pyRaven.data">
<span id="data-module"></span><h2>data module<a class="headerlink" href="#module-pyRaven.data" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyRaven.data.DataPacket">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">DataPacket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutfit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.DataPacket" title="Permalink to this definition"></a></dt>
<dd><p>Packet of data, convertable back and forth to and h5 file.</p>
<p>fitrange:
vsini:
wint_data:
wpol_data:
wint_rav:
wpol_rav:
original:
scaled:
cutfit:</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.data.DataPacket.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutfit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.DataPacket.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialization method for DataPacket
:param self: The object being initialized
:param fitrange: fitrange for the packet
:param vsini:
:param wint_rav:
:param wpol_rav:
:param original:
:param scaled:
:param cutfit:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.data.DataPacket.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.DataPacket.write" title="Permalink to this definition"></a></dt>
<dd><p>Method that writes a data packet to an h5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>packet</strong> – DataPacket object being stored in the file</p></li>
<li><p><strong>fname</strong> – name of the file to be written</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyRaven.data.LSDprofs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">LSDprofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lsds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.LSDprofs" title="Permalink to this definition"></a></dt>
<dd><p>Holds a list of LSD profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lsds</strong> – List of lsd profiles objects</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.data.LSDprofs.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lsds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.LSDprofs.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialization method for LSDprofs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – object being initialized</p></li>
<li><p><strong>lsds</strong> – list of lsd profiles objects</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.data.LSDprofs.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.LSDprofs.write" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that writes the contents of an LSDProfs object to an h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – h5 file being written</p></li>
<li><p><strong>lsds</strong> – LSDprofs object being stored in the file</p></li>
<li><p><strong>obs_names</strong> – (List of string) the IDs to be used for each observations</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.data.create_Packet">
<span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">create_Packet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_rav</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.create_Packet" title="Permalink to this definition"></a></dt>
<dd><p>Create a new DataPacket from meta information and a LSDprof object with the original LSD profiles. 
The creator function will calculate the scaled (radial velocity correction, normalization, LSD weigth scaling) version of the LSD profiles
based on the meta information provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star_name</strong> – (string) the name (or ID) for the star</p></li>
<li><p><strong>nobs</strong> – (int) the number of LSD profiles to be analyzed together</p></li>
<li><p><strong>obs_names</strong> – (list of strings) ID for the observations to be used in e.g. graphs (e.g. filename, obs number, etc)</p></li>
<li><p><strong>vrad</strong> – (1D array) radial velocity for the LSD profiles to put them in the stellar reference frame (if the LSD profiles are already in the star reference frame, just put an array of zeros)</p></li>
<li><p><strong>Ic</strong> – (1D array) continuum normalization values for the LSD profiles (if the LSD profiles are already normalized, just input an array of ones)</p></li>
<li><p><strong>wint_data</strong> – (1D array) the intensity weigth that was used to calculate the LSD profiles</p></li>
<li><p><strong>wpol_data</strong> – (1D array) the polarization weigth that was used to calculate the LSD profiles</p></li>
<li><p><strong>wint_rav</strong> – (float) the common LSD intensity weigth that will be used for all of the observations</p></li>
<li><p><strong>wpol_rav</strong> – (float) the common LSD intensity weigth that will be used for all of the observations</p></li>
<li><p><strong>fitrange</strong> – (float) the velocity range around the line center that will be use for the fitting</p></li>
<li><p><strong>vsini</strong> – (float) the vsini of the star (RIGHT NOW, ONLY FOR DISPLAY PURPOSES)</p></li>
<li><p><strong>original</strong> – (LSDprofs object) the original LSD profiles</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.data.read_lsd">
<span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">read_lsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.read_lsd" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that reads an lsd_prof from an h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – the h5 file with the data</p></li>
<li><p><strong>name</strong> – name of the LSDprofs object the data is a part of, with the index in the list</p></li>
</ul>
</dd>
<dt class="field-even">Rtype lsd_prof<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.data.read_lsds">
<span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">read_lsds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.read_lsds" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that reads an LSDprofs object from an h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – the h5 file with the data</p></li>
<li><p><strong>name</strong> – name of the LSDprof object (e.g. original, scaled, or cutfit)</p></li>
<li><p><strong>nobs</strong> – the number of LSD profiles in the LSDprof object.</p></li>
</ul>
</dd>
<dt class="field-even">Rtype LSDprof<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.data.read_lsds_from_sfiles">
<span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">read_lsds_from_sfiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fnames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.read_lsds_from_sfiles" title="Permalink to this definition"></a></dt>
<dd><p>Function to create a LSDprof object from a list of filenames for LSD profiles in the .s format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.data.read_packet">
<span class="sig-prename descclassname"><span class="pre">pyRaven.data.</span></span><span class="sig-name descname"><span class="pre">read_packet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.data.read_packet" title="Permalink to this definition"></a></dt>
<dd><p>Function that reads an h5 file and produces a DataPacket object from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – name of the h5 file being read</p>
</dd>
<dt class="field-even">Rtype DataPacket<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
</dd></dl>

</section>
<section id="module-pyRaven.params">
<span id="parameter-module"></span><h2>parameter module<a class="headerlink" href="#module-pyRaven.params" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyRaven.params.MyJSONEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyRaven.params.</span></span><span class="sig-name descname"><span class="pre">MyJSONEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipkeys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_circular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.MyJSONEncoder" title="Permalink to this definition"></a></dt>
<dd><p>Utility class to convert numpy arrays to list when using the json encoding</p>
<p>From <a class="reference external" href="https://python-forum.io/thread-35245.html">https://python-forum.io/thread-35245.html</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.params.MyJSONEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.MyJSONEncoder.default" title="Permalink to this definition"></a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.params.get_def_param_fitI">
<span class="sig-prename descclassname"><span class="pre">pyRaven.params.</span></span><span class="sig-name descname"><span class="pre">get_def_param_fitI</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.get_def_param_fitI" title="Permalink to this definition"></a></dt>
<dd><p>Function that returns a <cite>parameters</cite> dictionary with default values 
for parameters that are necessary for the intensity profile fitting</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.params.get_def_param_weak">
<span class="sig-prename descclassname"><span class="pre">pyRaven.params.</span></span><span class="sig-name descname"><span class="pre">get_def_param_weak</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.get_def_param_weak" title="Permalink to this definition"></a></dt>
<dd><p>Function that returns a <cite>parameters</cite> dictionary with default values 
for parameters that are necessary for a typical weak field calculation</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyRaven.params.parameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyRaven.params.</span></span><span class="sig-name descname"><span class="pre">parameters</span></span><a class="headerlink" href="#pyRaven.params.parameters" title="Permalink to this definition"></a></dt>
<dd><p>Class to add functionalities to the <cite>param</cite> dictionaries.</p>
<p>Usage: to param = parameters(param) to use the <cite>write</cite> and <cite>pprint</cite> functions.</p>
<p>ADD LINK to info page about the param dictionaries</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.params.parameters.pprint">
<span class="sig-name descname"><span class="pre">pprint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.parameters.pprint" title="Permalink to this definition"></a></dt>
<dd><p>Method to pretty-print a <cite>parameters</cite> dictionary in a readable manner</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyRaven.params.parameters.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.parameters.write" title="Permalink to this definition"></a></dt>
<dd><p>Method to write the parameter dictionary to a json file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – a <cite>parameters</cite> dictionary that can contain numpy arrays (they will be converted to list)</p></li>
<li><p><strong>fname</strong> – (string) the name of the .json file to write</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.params.read_parameters">
<span class="sig-prename descclassname"><span class="pre">pyRaven.params.</span></span><span class="sig-name descname"><span class="pre">read_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.params.read_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Function to read a parameters dictionary that has been written to file
as a .json file. 
IMPORTANT NOTE: if some of the keys originally contained a numpy array prior to being written to file,
they will now be in the form of python lists. It is important to transform them back into numpy array if you want to use them as such.</p>
<p>TODO: decide if we want to return a plain dictionary or a parameters class dictionary?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the name of the .json file</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyRaven.pattern">
<span id="pattern-module"></span><h2>pattern module<a class="headerlink" href="#module-pyRaven.pattern" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyRaven.profileI">
<span id="profilei-module"></span><h2>profileI module<a class="headerlink" href="#module-pyRaven.profileI" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.profileI.voigt_fara">
<span class="sig-prename descclassname"><span class="pre">pyRaven.profileI.</span></span><span class="sig-name descname"><span class="pre">voigt_fara</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.profileI.voigt_fara" title="Permalink to this definition"></a></dt>
<dd><p>Calculation of Voigt and Faraday-Voigt profiles</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param u<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of frequency in doppler width units.</p>
</dd>
<dt class="field-even">param a<span class="colon">:</span></dt>
<dd class="field-even"><p>damping coefficient</p>
</dd>
<dt class="field-odd">return w<span class="colon">:</span></dt>
<dd class="field-odd"><p>complex array where Voigt is the real component and Voigt-Fara is the imaginary component.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</section>
<section id="module-pyRaven.localV">
<span id="localv-module"></span><h2>localV module<a class="headerlink" href="#module-pyRaven.localV" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.localV.unno_local_out_IV">
<span class="sig-prename descclassname"><span class="pre">pyRaven.localV.</span></span><span class="sig-name descname"><span class="pre">unno_local_out_IV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ua</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sin_2chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cos_2chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.localV.unno_local_out_IV" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a local line profile in all Stokes paramters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ub</strong> – the lambda_B in doppler width units.</p></li>
<li><p><strong>ua</strong> – local radial velocity in doppler width units.</p></li>
<li><p><strong>pattern</strong> – a zeeman pattern dictionary returned by the zeeman_pattern function</p></li>
<li><p><strong>small_u</strong> – the uo array for the w array that contains the centered line profile function</p></li>
<li><p><strong>w</strong> – the line profile function centered at uo=0, calculated over small_u (the profile functions are shifted and interpolated for the addition of all the zeeman components, instead of recalculated, to same computation time).</p></li>
<li><p><strong>all_u</strong> – the full wavelength array in doppler width units. It need to be larger enough to accomodate the largest zeeman and rotational shifts.</p></li>
<li><p><strong>sin_theta</strong> – sin of the angle between the local magnetic field and the LOS.</p></li>
<li><p><strong>cos_theta</strong> – cos of the angle between the local magnetic field and the LOS.</p></li>
<li><p><strong>sin_2chi</strong> – sin of 2x the angle between the local magnetic field and the reference direction in the plane of the sky</p></li>
<li><p><strong>cos_2chi</strong> – cos of 2x the angle between the local magnetic field and the reference direction in the plane of the sky</p></li>
<li><p><strong>kappa</strong> – the line strength parameter</p></li>
<li><p><strong>bnu</strong> – the slope of the source function with respect to the vertical optical depth</p></li>
<li><p><strong>mu</strong> – the angle between the normal to the surface and the LOS.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="id1">
<h2>localV module<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<span class="target" id="module-pyRaven.diskint2"></span><dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.analytical">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">analytical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.analytical" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate an intensity line profile using an analytical convolution</p>
<p>The necessary keys in the parameters dictionary object are:
- general/vsini
- general/logkappa
- general/bnu
- general/vdop
- general/ndop
- general/av
- general/lambda0</p>
<p>Note: if the vsini is less then vdop/2, then the function directly returns the non-rotating line profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param</strong> – a parameters dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_B_LOS">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_B_LOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B_MAG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag2rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot2los</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_B_LOS" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert the magnetic field vectors in the MAG coordinate system to the LOS coordinate system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B_MAG</strong> – the (3, n_real) matric with Bx, By, Bz of the grid points in the MAG coordinate</p></li>
<li><p><strong>mag2rot</strong> – the mag to rot rotation matrix</p></li>
<li><p><strong>rot2los</strong> – the rot to los rotation matrix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_B_MAG">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_B_MAG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MAG</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_B_MAG" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the field values on the MAG grid in (Bpole/2) units</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>MAG</strong> – the MAG (3, n_real) coordinate grid</p>
</dd>
<dt class="field-even">Return B_MAG<span class="colon">:</span></dt>
<dd class="field-even"><p>a (3, n_real) matric with Bx, By, Bz of the grid points in the MAG coordinate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_LOS">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_LOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ROT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot2los</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_LOS" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert a ROT grid coordinates into LOS coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ROT</strong> – the (3, n_real) matrix for the x,y,z coordinates of each grid points</p></li>
<li><p><strong>rot2los</strong> – the rotation matrix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_LOS_values">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_LOS_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_LOS_values" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the mu angle, a bolean value for visibility, the projected area and velocity of each grid point, 
along with the integrated continuum flux for profile normalization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LOS</strong> – The (3, n_real) grid coordinates in LOS coordinates</p></li>
<li><p><strong>A</strong> – the area of each grid point</p></li>
<li><p><strong>S1</strong> – the slope of the source function</p></li>
<li><p><strong>vsini</strong> – projected rotational equatorial velocity (in km/s)</p></li>
<li><p><strong>vdop</strong> – the thermal broadening velocity (in km/s)</p></li>
</ul>
</dd>
</dl>
<p>returns
* mu_LOS: angle between the surface normal and the line-of-sight
* vis: boolean array, TRUE is the grid point is visible
* A_LOS: the projected area of the visible grid points normalized to unity
* uLOS: the projected rotational velocity of the grid points in uo units. 
* conti_flux: the integrated continuum flux for profile normalization.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_MAG">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_MAG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ROT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot2mag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_MAG" title="Permalink to this definition"></a></dt>
<dd><p>Function to convert a ROT grid coordinates into MAG coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ROT</strong> – the (3, n_real) matrix for the x,y,z coordinates of each grid points</p></li>
<li><p><strong>rot2mag</strong> – the rotation matrix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_all_u">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_all_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vel_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_all_u" title="Permalink to this definition"></a></dt>
<dd><p>Function to create the larger dispersion array (in uo units) that will accomodate the whole disk-integrated profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_range</strong> – the range needed to accomodate the profile in uo units. NOTE: the code with round up to a integer bound</p></li>
<li><p><strong>ndop</strong> – the number of datapoints per sigma (use the same as for the small dispersion array, please)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_empty_model">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_empty_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_empty_model" title="Permalink to this definition"></a></dt>
<dd><p>Function to create a structure to save the final model. If unno=True, IQUV, else, just IV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_u</strong> – the total dispersion array in uo units</p></li>
<li><p><strong>vdop</strong> – the thermal broadening in km/s</p></li>
<li><p><strong>lambda0</strong> – rest wavelength of transition in AA.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_local_weak_interp">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_local_weak_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">small_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_weak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw_weak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uLOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_LOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_local_weak_interp" title="Permalink to this definition"></a></dt>
<dd><p>Function to get the local I and V from the weak field approximation, by using an interpolation of a 
fixed profile function in the rest frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_u</strong> – the uo grid on which the profile is defined</p></li>
<li><p><strong>w_weak</strong> – the voigt profile (already divided by sqrt(2pi))</p></li>
<li><p><strong>dw_weak</strong> – the derivative of the voigt profile with respect to uo</p></li>
<li><p><strong>all_u</strong> – the (larger) dispersion grid on which to interpolate (enough to encompase the vsini) in uo units</p></li>
<li><p><strong>uLOS</strong> – the (rotational) radial velocity of the grid point in uo units</p></li>
<li><p><strong>mu_LOS</strong> – the mu angle of the grid point (angle between LOS and normal to surface)</p></li>
<li><p><strong>bnu</strong> – the slope of the source function with respect to tau_z (the vertical optical depth, the change in slope because of the mu angle is coded in)</p></li>
<li><p><strong>kappa</strong> – the line strenght parameter</p></li>
<li><p><strong>Bz</strong> – the Bz of that grid point (in Bpole/2 units)</p></li>
</ul>
</dd>
</dl>
<p>returns: the local_I and local_V profiles, used for disk integration. 
The local_I and local_V need to be multiplied by the projected area (A_LOS) of the grid point during the integration.
Furthermore, the local_V needs to be multiplied (can be done after the integration) by geff * Bpole/2 * kappa * perGaussLorentz,
where perGaussLorentz(lambda0, vdop) is defined in the explanatory notebook.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_local_weak_interp_Vonly_numba">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_local_weak_interp_Vonly_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">small_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_weak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw_weak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uLOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_LOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_local_weak_interp_Vonly_numba" title="Permalink to this definition"></a></dt>
<dd><p>Function to get the local V only (for the loop) from the weak field approximation, by using an interpolation of a 
fixed profile function in the rest frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_u</strong> – the uo grid on which the profile is defined</p></li>
<li><p><strong>w_weak</strong> – the voigt profile (already divided by sqrt(2pi))</p></li>
<li><p><strong>dw_weak</strong> – the derivative of the voigt profile with respect to uo</p></li>
<li><p><strong>all_u</strong> – the (larger) dispersion grid on which to interpolate (enough to encompase the vsini) in uo units</p></li>
<li><p><strong>uLOS</strong> – the (rotational) radial velocity of the grid point in uo units</p></li>
<li><p><strong>mu_LOS</strong> – the mu angle of the grid point (angle between LOS and normal to surface)</p></li>
<li><p><strong>bnu</strong> – the slope of the source function with respect to tau_z (the vertical optical depth, the change in slope because of the mu angle is coded in)</p></li>
<li><p><strong>kappa</strong> – the line strenght parameter</p></li>
<li><p><strong>Bz</strong> – the Bz of that grid point (in Bpole/2 units)</p></li>
</ul>
</dd>
</dl>
<p>returns: local_V profile, used for disk integration. 
The local_V need to be multiplied by the projected area (A_LOS) of the grid point during the integration.
Furthermore, the local_V needs to be multiplied (can be done after the integration) by geff * Bpole/2 * kappa * perGaussLorentz,
where perGaussLorentz(lambda0, vdop) is defined in the explanatory notebook.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_los2rot">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_los2rot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_los2rot" title="Permalink to this definition"></a></dt>
<dd><p>Function to get the rotation matrix that converts from LOS coordinates to ROT coordinates. 
NOTE: The angles are passed in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incl</strong> – the inclination of the rotational axis to the line of sight</p></li>
<li><p><strong>phase</strong> – the rotational phase (see documentation notebook for the rotation coordinate system conventions)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_ngrid">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_ngrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_ngrid" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the number of spatial grid point necessary for a given vsini.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_perGaussLorentz">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_perGaussLorentz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_perGaussLorentz" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the perGaussLorentz (in 1/Gauss) constant for a given central wavelength and thermal broadening.</p>
<ul class="simple">
<li><p>For the unno calculation: This gets multiplied by B in the disk integration to get uB,i.</p></li>
<li><p>For the weak-field approximation calculation: This gets multiplied by geff*Bz and the Stokes V shape in the disk integration to get V(uo)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lambda0</strong> – central wavelength in AA.</p></li>
<li><p><strong>vdop</strong> – thermal broadening in km/s</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_resmac_kernel">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_resmac_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uconv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_resmac_kernel" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate a combined gaussian kernel for macroturbulence and spectral resolution
Returns an astropy kernel object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_u</strong> – dispersion array in uo units on which the kernel will be calculated</p></li>
<li><p><strong>uconv</strong> – the sigma of the gaussian kernel in uo units.</p></li>
</ul>
</dd>
</dl>
<p>Should be set to ( u_rot**2 + u_res**2 )**0.5</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_rot2mag">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_rot2mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_rot2mag" title="Permalink to this definition"></a></dt>
<dd><p>Function to get the rotation matrix that converts from ROT coordinates to MAG coordinates. 
NOTE: The angles are passed in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>beta</strong> – the obliquity of the magnetic axis to the rotational axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_rotKernel">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_rotKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">urot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_rotKernel" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to get the rotational covolution profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uo</strong> – (numpy array) the velocity array in u0 units (v/vthermal)</p></li>
<li><p><strong>S1</strong> – the slope of the source function</p></li>
</ul>
</dd>
</dl>
<p>(see ADD LINK for conversion between the slope of the source function and epsilon)
:param urot: the vsini in u0 units (vsini / vthermal)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_small_u">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_small_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_small_u" title="Permalink to this definition"></a></dt>
<dd><p>Function to return the small dispersion grid (in uo units) for the Voigt-Fara profile calculations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig</strong> – number of sigmas from line center for the range (usually 8-10)</p></li>
<li><p><strong>ndop</strong> – number of datapoints per sigma (usually 5-10)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_uconv">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_uconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_uconv" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate and return the combined sigma of the gaussian kernel that will 
perform the convolution for the macroturbulence and the spectral instrument resolution
:param param: a parameter dictionary</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_unno_angles">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_unno_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B_LOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bpole</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_unno_angles" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate for each grid point:
1. The angles between the magnetic field vectors and the line of sight (cos(theta), sin(theta), cos(2*chi), sin(2*chi))
2. The magnitude of the magnetic field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>B_LOS</strong> – the (3, n_real) matric with Bx, By, Bz of the grid points in the LOS coordinate system</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_vel_range_unno">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_vel_range_unno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bpole</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perGaussLorentz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini_over_vdop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_vel_range_unno" title="Permalink to this definition"></a></dt>
<dd><p>Function to figure out the length of vector that we need for the velocity grid, for the Unno solution.
Takes the max of the Zeeman shift or the vsini, then add the sig*vdop widths.
to accomodate the whole w(small_u) array shifted to the maximum value possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – the zeeman pattern object</p></li>
<li><p><strong>Bpole</strong> – the dipolar (or max) field strength</p></li>
</ul>
</dd>
<dt class="field-even">PerGaussLorentz<span class="colon">:</span></dt>
<dd class="field-even"><p>the perGaussLorentz constant for that specific central wavelenght and thermal broadening.</p>
</dd>
<dt class="field-odd">Vsini_over_vdop<span class="colon">:</span></dt>
<dd class="field-odd"><p>the rotational broadening in uo units.</p>
</dd>
<dt class="field-even">Sig<span class="colon">:</span></dt>
<dd class="field-even"><p>the width in sigma that was used to calculate the small dispersion array (the one used to calculated the Voigt profile)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_w_unno">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_w_unno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">small_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_w_unno" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the Voigt and Voigt-Faraday profiles over the given dispersion grid (in uo units). 
It will also pad the array at both ends with zeros for one sigma. 
Note: the result is an array of complex numbers. The real part is the Voigt profile and the imaginary part is the Voigt-Faraday profile.
Note: Used by the unno solution. The profile is NOT normalized (so not mulitplied by 1/sqrt(pi), because this is done in the local profile function calculation)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_u</strong> – the dispersion grid in uo units</p></li>
<li><p><strong>av</strong> – the damping factor</p></li>
<li><p><strong>ndop</strong> – the number of datapoint per sigma used in the creation of the dispersion array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.get_w_weak">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">get_w_weak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">small_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.get_w_weak" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the normalized (so mulitplied by 1/sqrt(pi)) local profile, and the derivative of the local profile, 
to be used in the the weak-field approximation. 
It will also pad the array at both ends with zeros for one sigma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_u</strong> – the dispersion grid in uo units</p></li>
<li><p><strong>av</strong> – the damping factor</p></li>
<li><p><strong>ndop</strong> – the number of datapoint per sigma used in the creation of the dispersion array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.grid_ROT">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">grid_ROT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngrid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.grid_ROT" title="Permalink to this definition"></a></dt>
<dd><p>Function to set up the grid at the surface of the star,
in the rotation frame of reference. 
NOTE: the final number of grid point might be slightly different than the input,
as the code attempts to have grid points with roughtly the same surface area.
Returns:
* a (3, n_real) matrix for the x,y,z coordinates of each grid points
* a (n_real) array with the surface area of each grid point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ngrid</strong> – the number of spatial gridpoints on the sphere.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.model_convolve_resvmac">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">model_convolve_resvmac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.model_convolve_resvmac" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to convolve a model with a kernel. 
The flux convolution has a fill_value=1.0, and the Stokes convolution have fill_value=0.0. 
Note – this function does not extend the arrays. The checks on the kernel is performed in the calling function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – a model object</p></li>
<li><p><strong>kernel</strong> – an astropy kernel object</p></li>
<li><p><strong>unno</strong> – (True) flag for a unno calculation. If True, will convolve Q and U.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.numerical">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">numerical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.numerical" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculated a line profile using a numerical disk integration, 
either in the weak-field approximation (unno=False, default)
or with the Unno solution (unno=True).</p>
<p>The necessary keys in the parameters dictionary object are:
- general/vsini
- general/logkappa
- general/bnu
- general/vdop
- general/ndop
- general/av
- general/lambda0
- general/Bpole
- general/incl
- general/beta
- general/phase</p>
<p>If general/res and general/vmac are not present, the former will be set to infinity and the latter to zero</p>
<p>For the weak field approximation
- weak/geff
For the Unno calculation
- unno/up
- unno/down</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.pad_V">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">pad_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ext_all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.pad_V" title="Permalink to this definition"></a></dt>
<dd><p>Helper function for the loop that pads Stokes V to accomodate a convolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ext_all_u</strong> – the new uo array</p></li>
<li><p><strong>all_u</strong> – the existing uo array</p></li>
<li><p><strong>V</strong> – the Stokes V model defined on all_u</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.diskint2.pad_model">
<span class="sig-prename descclassname"><span class="pre">pyRaven.diskint2.</span></span><span class="sig-name descname"><span class="pre">pad_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_ext_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.diskint2.pad_model" title="Permalink to this definition"></a></dt>
<dd><p>Function to pad a model object with 1.0 (intensity) or 0.0 (Stokes) in order to accomodate a convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model to pad</p></li>
<li><p><strong>input_ext_model</strong> – the extended empty model object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyRaven.loop">
<span id="loop-module"></span><h2>loop module<a class="headerlink" href="#module-pyRaven.loop" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.loop.loop">
<span class="sig-prename descclassname"><span class="pre">pyRaven.loop.</span></span><span class="sig-name descname"><span class="pre">loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datapacket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.loop.loop" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the chi square between 
all of the LSD profiles in a pyRaven data packet and 
the Stokes V profiles for a grid of dipole paramters 
(inclination, beta, phase, and Bpole)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> – For now, see the documentation notebook for the content of the param dictionary.</p></li>
<li><p><strong>datapacket</strong> – a pyRaven datapacket for a given set of observations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyRaven.loop.loop_wrapper">
<span class="sig-prename descclassname"><span class="pre">pyRaven.loop.</span></span><span class="sig-name descname"><span class="pre">loop_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_datapacket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyRaven.loop.loop_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>This function is a wrapper to the loop function. 
It it designed to be run in a directory that contains a parameters json file, and a DataPacket h5 file. 
The output are written in the same directory by default.</p>
<p>This wrapper is useful to generate the chi2 data on a remote server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_param</strong> – A json file containing the parameter object (see INSERT LINK)</p></li>
<li><p><strong>file_datapackt</strong> – A h5 file containing the DataPacket structure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nblink/04-CalculateProbabilities.html" class="btn btn-neutral float-left" title="04 - Calculate probabilites from the chi2 files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, V. Petit.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>